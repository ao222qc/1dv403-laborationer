{"changed":false,"filter":false,"title":"script.js","tooltip":"/4-thequiz/script.js","value":"\"use strict\";\n\nvar quiz =\n{\n    requesting:new XMLHttpRequest(),\n    numberOfTries:0,\n    currentQuestion:null,\n    results:[],\n    triesPerQuestion:null,\n    i:0,\n\n    init:function()\n\n    {\n        document.getElementById(\"button\").onclick = function()\n        {quiz.question(\"http://vhost3.lnu.se:20080/question/1\");};\n    },\n\n    question:function(url)\n    {\n        var getRequest = quiz.request(url, null);\n\n        getRequest.onreadystatechange = function()\n        {\n            if (getRequest.readyState === 4 && getRequest.status === 200)\n            {\n                var responseT = JSON.parse(getRequest.responseText);\n                quiz.currentQuestion = responseT.question;\n\n                document.getElementById(\"question\").innerHTML = responseT.question;\n                quiz.answer(responseT.nextURL);\n            }\n            if (getRequest.status === 404 && getRequest.readyState === 4)\n            {\n                var end = confirm(\"Bra jobbat! Tryck 'OK' för spännande statistik.\");\n\n                var presentResult =  document.getElementById(\"results\");\n\n                if(end === true)\n                {\n                    for (var i = 1; i < quiz.results.length; i++) {\n                        var result = document.createElement(\"p\");\n                        result.innerHTML = quiz.results[i];\n                        presentResult.appendChild(result);\n                    }\n                }\n                else\n                {\n                    presentResult.innerHTML = \"Tråkigt att du skäms så över dina resultat.\";\n                }\n            }\n        };\n    },\n\n        request:function(url, whatToSend)\n        {\n            if(whatToSend != null)\n            {\n                quiz.requesting.open(\"POST\", url, true);\n                quiz.requesting.setRequestHeader(\"Content-Type\", \"application/json\");\n            }\n            else\n            {\n                quiz.requesting.open(\"GET\", url, true);\n            }\n            quiz.requesting.send(whatToSend);\n            return quiz.requesting;\n        },\n\n    answer:function(url)\n    {\n        document.getElementById(\"sendbutton\").onclick = function()\n        {\n            quiz.i += 1;\n            quiz.numberOfTries += 1;\n            var tryperquestion = \"Fråga: '\" + quiz.currentQuestion + \"' tog dig \" + quiz.numberOfTries + \" försök.\";\n            quiz.results[quiz.i] = tryperquestion;\n\n            var answer = document.getElementById(\"textarea\").value;\n            var object = {\"answer\" : answer};\n            var response = JSON.stringify(object);\n\n            if(isNaN(parseFloat(answer)))\n            {\n                alert(\"Felaktig input, försök igen.\");\n            }\n            else\n            {\n                quiz.sendanswer(url, response);\n            }\n        };\n    },\n\n    sendanswer:function(url, answer)\n    {\n        var sendRequest = quiz.request(url, answer);\n\n        sendRequest.onreadystatechange = function()\n        {\n            if(sendRequest.readyState === 4 && sendRequest.status === 200)\n            {\n                var responseA = JSON.parse(sendRequest.responseText);\n                quiz.numberOfTries = 0;\n                quiz.question(responseA.nextURL);\n                //alert(\"funkar\");\n            }\n            if (sendRequest.status === 400 && sendRequest.readyState === 4)\n            {       if(quiz.i >= 1)\n                    {\n                        quiz.i -= 1;\n                    }\n                alert(\"Fel! Stäng rutan med 'OK' och försök igen!\");\n                //quiz.currentQuestion -= 1;\n            }\n        };\n    }\n};\nwindow.onload = quiz.init;","undoManager":{"mark":0,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":1320,"scrollleft":20.8,"selection":{"start":{"row":32,"column":73},"end":{"row":32,"column":73},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":90,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1420630484644}